(()=>{var t={n:a=>{var e=a&&a.__esModule?()=>a.default:()=>a;return t.d(e,{a:e}),e},d:(a,e)=>{for(var n in e)t.o(e,n)&&!t.o(a,n)&&Object.defineProperty(a,n,{enumerable:!0,get:e[n]})},o:(t,a)=>Object.prototype.hasOwnProperty.call(t,a)};(()=>{"use strict";const a=flarum.core.compat.app;var e=t.n(a);const n=flarum.core.compat["common/components/Button"];var r=t.n(n),s="yippy-auth-ldap.",o="yippy-auth-ldap.admin.settings.",i=s+"domains",l=["cn","commonName","displayName","name","title","personalTitle","givenName","initials","sn","surname"],d=["mail","rfc822Mailbox "],c=["mailNickname","sAMAccountName","uid","userPrincipalName"],u=["mailNickname","sAMAccountName","uid","userPrincipalName","mail","rfc822Mailbox "],p=function(t,a){void 0===t&&(t=[]),void 0===a&&(a=[]);for(var e=0;e<a.length;e++)t.indexOf(a[e])>0&&t.splice(e,0,t.splice(t.indexOf(a[e]),1)[0]);return t};e().initializers.add("yippy-auth-ldap",(function(t){t.extensionData.for("yippy-auth-ldap").registerSetting({setting:s+"method_name",label:t.translator.trans(o+"method_name"),type:"text",placeholder:"YunoHost"}).registerSetting((function(){var a,e=this;try{a=JSON.parse(this.setting(i)())}catch(t){}return console.log(null==a[0].isEnabled?"true":"false"),Array.isArray(a)||(a=[]),m(".Form-group",[m("label",t.translator.trans(o+"domains.title")),m(".helpText",t.translator.trans(o+"domains.description")),m("table",{style:"table-layout:fixed"},[m("tbody",[a.map((function(n,s){return m("table",{border:"1px solid black",style:n.isEnabled||null==n.isEnabled?"background-color: #ffffff":"background-color: #F88379"},[m("thead",m("tr",[m("th",t.translator.trans(o+"domains.banner",{index:s+1,isEnabled:n.isEnabled||null==n.isEnabled?t.translator.trans(o+"domains.is_enabled.enabled"):t.translator.trans(o+"domains.is_enabled.disabled")})),m("th",r().component({className:"Button Button--icon",icon:"fas fa-times",onclick:function(){a.splice(s,1),e.setting(i)(a.length>0?JSON.stringify(a):null)}}))])),m("tbody",[m("table",[m("thead",m("tr",[m("th",{width:"30%"}),m("th",{width:"70%"})])),m("tbody",[m("tr",[m("th",{colspan:2},t.translator.trans(o+"domains.header.server"))]),m("tr",[m("td",t.translator.trans(o+"domains.data.host")),m("td",m("input.FormControl",{type:"text",value:n.host||"",placeholder:"localhost",onchange:function(t){n.host=t.target.value,e.setting(i)(JSON.stringify(a))}}))]),m("tr",[m("td",{colspan:2,class:"helpText"},t.translator.trans(o+"domains.data.host_help"))]),m("tr",[m("td",t.translator.trans(o+"domains.data.port")),m("td",m("input.FormControl",{type:"number",value:n.port||389,placeholder:"389",onchange:function(t){n.port=Number(t.target.value),e.setting(i)(JSON.stringify(a))}}))]),m("tr",[m("td",{colspan:2,class:"helpText"},t.translator.trans(o+"domains.data.port_help"))]),m("tr",[m("td",t.translator.trans(o+"domains.data.version")),m("td",m("input.FormControl",{type:"number",value:n.version||3,placeholder:"3",onchange:function(t){n.version=Number(t.target.value),e.setting(i)(JSON.stringify(a))}}))]),m("tr",[m("td",{colspan:2,class:"helpText"},t.translator.trans(o+"domains.data.version_help"))]),m("tr",[m("td",t.translator.trans(o+"domains.data.base_dn")),m("td",m("input.FormControl",{type:"text",value:n.baseDN||"",placeholder:"ou=users,dc=yunohost,dc=org",onchange:function(t){n.baseDN=t.target.value,e.setting(i)(JSON.stringify(a))}}))]),m("tr",[m("td",{colspan:2,class:"helpText"},t.translator.trans(o+"domains.data.base_dn_help"))]),m("tr",[m("td",t.translator.trans(o+"domains.data.filter")),m("td",m("input.FormControl",{type:"text",value:n.filter||"",placeholder:"(&(objectClass=posixAccount)(permission=cn=flarum.main,ou=permission,dc=yunohost,dc=org)",onchange:function(t){n.filter=t.target.value,e.setting(i)(JSON.stringify(a))}}))]),m("tr",[m("td",{colspan:2,class:"helpText"},t.translator.trans(o+"domains.data.filter_help"))]),m("tr",[m("td",t.translator.trans(o+"domains.data.follow_referrals")),m("td",m("input",{type:"checkbox",checked:n.followReferrals,onchange:function(t){n.followReferrals=t.target.checked,e.setting(i)(JSON.stringify(a))}}))]),m("tr",[m("td",t.translator.trans(o+"domains.data.use_ssl")),m("td",m("input",{type:"checkbox",checked:n.useSSL,onchange:function(t){n.useSSL=t.target.checked,e.setting(i)(JSON.stringify(a))}}))]),m("tr",[m("td",t.translator.trans(o+"domains.data.use_tls")),m("td",m("input",{type:"checkbox",checked:n.useTLS,onchange:function(t){n.useTLS=t.target.checked,e.setting(i)(JSON.stringify(a))}}))]),m("tr",[m("th",{colspan:2},t.translator.trans(o+"domains.header.admin"))]),m("tr",[m("td",t.translator.trans(o+"domains.data.admin_dn")),m("td",m("input.FormControl",{type:"text",value:n.admin.dn||"",placeholder:"cn=admin,dc=yunohost,dc=org",onchange:function(t){n.admin.dn=t.target.value,e.setting(i)(JSON.stringify(a))}}))]),m("tr",[m("td",{colspan:2,class:"helpText"},t.translator.trans(o+"domains.data.admin_dn_help"))]),m("tr",[m("td",t.translator.trans(o+"domains.data.admin_password")),m("td",m("input.FormControl",{type:"text",value:n.admin.password||"",placeholder:"password",onchange:function(t){n.admin.password=t.target.value,e.setting(i)(JSON.stringify(a))}}))]),m("tr",[m("td",{colspan:2,class:"helpText"},t.translator.trans(o+"domains.data.admin_password_help"))]),m("tr",[m("th",{colspan:2},t.translator.trans(o+"domains.header.search_fields"))]),m("tr",[m("td",{colspan:2},t.translator.trans(o+"domains.header.search_fields_description"))]),m("tr",[m("td",t.translator.trans(o+"domains.data.search_user_fields")),m("td",m("select",{oncreate:function(t){var a=t.dom;return $(a).select2({width:"100%",multiple:!0,data:p(u,n.searchFields)}).on("change",(function(){this.dispatchEvent(new CustomEvent("edit",{detail:$(this).val()}))})).on("select2:select",(function(t){var a=t.params.data.id,e=$(t.target).children("[value="+a+"]");e.detach(),$(t.target).append(e).change()})).val(n.searchFields||[]).trigger("change")},onedit:function(t){n.searchFields=t.detail,e.setting(i)(JSON.stringify(a))}}))]),m("tr",[m("td",{colspan:2,class:"helpText"},t.translator.trans(o+"domains.data.search_user_fields_help"))]),m("tr",[m("th",{colspan:2},t.translator.trans(o+"domains.header.flarum"))]),m("tr",[m("td",{colspan:2},t.translator.trans(o+"domains.header.flarum_description"))]),m("tr",[m("td",t.translator.trans(o+"domains.data.user_username")),m("td",m("select",{value:n.user.username||"",oncreate:function(t){var a=t.dom;return $(a).select2({width:"100%",allowClear:!0,placeholder:""}).on("change",(function(){this.dispatchEvent(new CustomEvent("edit",{detail:this.value}))}))},onedit:function(t){n.user.username=t.detail,e.setting(i)(JSON.stringify(a))}},[c.map((function(t){return[m("option",{value:t},t)]}))]))]),m("tr",[m("td",t.translator.trans(o+"domains.data.user_mail")),m("td",m("select",{value:n.user.mail||"",oncreate:function(t){var a=t.dom;return $(a).select2({width:"100%",allowClear:!0,placeholder:""}).on("change",(function(){this.dispatchEvent(new CustomEvent("edit",{detail:this.value}))}))},onedit:function(t){n.user.mail=t.detail,e.setting(i)(JSON.stringify(a))}},[d.map((function(t){return[m("option",{value:t},t)]}))]))]),m("tr",[m("td",{colspan:2,class:"helpText"},t.translator.trans(o+"domains.data.user_mail_help"))]),m("tr",[m("td",t.translator.trans(o+"domains.data.user_nickname_fields")),m("td",m("select",{oncreate:function(t){var a=t.dom;return $(a).select2({width:"100%",multiple:!0,data:p(l,n.user.nicknameFields)}).on("change",(function(){this.dispatchEvent(new CustomEvent("edit",{detail:$(this).val()}))})).on("select2:select",(function(t){var a=t.params.data.id,e=$(t.target).children("[value="+a+"]");e.detach(),$(t.target).append(e).change()})).val(n.user.nicknameFields||[]).trigger("change")},onedit:function(t){n.user.nicknameFields=t.detail,e.setting(i)(JSON.stringify(a))}}))]),m("tr",[m("td",{colspan:2,class:"helpText"},t.translator.trans(o+"domains.data.user_nickname_fields_help"))]),m("tr",[m("td",t.translator.trans(o+"domains.data.is_enabled")),m("td",m("input",{type:"checkbox",checked:n.isEnabled||null==n.isEnabled,onchange:function(t){n.isEnabled=t.target.checked,e.setting(i)(JSON.stringify(a))}}))])])])])])})),m("tr",m("td",r().component({className:"Button Button--block",onclick:function(){a.push({host:"",port:389,version:3,baseDN:"",filter:"",admin:{dn:"",password:""},searchFields:[],user:{username:"",mail:"",nicknameFields:[]},followReferrals:!1,useSSL:!1,useTLS:!1}),e.setting(i)(JSON.stringify(a))}},t.translator.trans(o+"domains.add"))))])])])})).registerSetting({setting:s+"onlyUse",label:t.translator.trans(o+"onlyUse"),type:"boolean",default:!1}).registerSetting({setting:s+"display_detailed_error",label:t.translator.trans(o+"display_detailed_error"),type:"boolean",default:!1})}))})(),module.exports={}})();
//# sourceMappingURL=admin.js.map